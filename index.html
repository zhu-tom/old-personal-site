<!DOCTYPE html>
<html>
    <head>
        <title>Tom Zhu</title>
        <link rel="apple-touch-icon" sizes="180x180" href="./resources/favicon/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="./resources/favicon/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="./resources/favicon/favicon-16x16.png">
        <link rel="manifest" href="./resources/favicon/site.webmanifest">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
        <style>
            .jumbotron {
                margin: 0;
                background: transparent;
            }

            .container {
               width: 75%; 
            }

            body {
                box-shadow: inset 0 0 5rem rgba(0, 0, 0, .5);
                color: #ffffff;
                text-shadow: 0 .05rem .1rem rgba(0, 0, 0, .5);
                background: #343a40;
                animation: fadeIn 3s;
            }

            .section-hidden {
                visibility: hidden;
            }

            .section-shown {
                visibility: visible;
                animation: slideUp 1.5s forwards, fadeIn ease-in 1.5s;
            }

            .divider {
                border-top: 1px #ffffff solid;
                margin-top: 5rem;
                margin-bottom: 5rem;
            }

            .divider-hidden {
                width: 0%;
            }

            .divider-expanded {
                width: 66%;
                animation: expand 1.5s;
            }

            .nav-hidden {
                animation: fadeOut 0.5s;
            }

            .nav-shown {
                visibility: visible;
                animation: fadeIn 0.75s;
            }

            @keyframes fadeIn {
                0% {opacity: 0;}
                100% {opacity: 1;}
            }

            @keyframes expand {
                0% {width: 0%;}
                100% {width: 66%;}
            }

            @keyframes slideUp {
                0% {transform: translateY(250px);}
                100% {transform: translateY(0);}
            }

            @keyframes fadeOut {
                0% {opacity: 1;}
                100% {opacity: 0;}
            }
        </style>
    </head>
    <body class="bg-dark">
        <div class="jumbotron">
            <p class="text-center display-1">Hi, I'm Tom.</p>
        </div>
        <nav class="navbar navbar-expand-lg navbar-dark justify-content-center">
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-center" id="navbarNav">
                <ul class="navbar-nav" id="topNav">
                    <li class="nav-item active">
                        <a class="nav-link" href="#about">About</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#projects">Projects</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#experience">Experience</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#contact">Contact</a>
                    </li>
                </ul>
            </div>
        </nav>
        <div style="text-align: center;">
            <a style="color: inherit;" href="#">
                <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0.5" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"></polyline></svg>
            </a>
        </div>
        <div class="row justify-content-start">
            <div class="col-2">
                <nav id="fullNav" class="navbar nav-hidden navbar-expand-lg sticky-top navbar-dark">
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#sidebar" aria-controls="sidebar" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div id="sidebar" class="collapse navbar-collapse">
                        <ul id="sideNav" class="navbar-nav flex-column">
                            <li class="nav-item">
                                <a class="nav-link" href="#about">About</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#projects">Projects</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#experience">Experience</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#contact">Contact</a>
                            </li>
                        </ul>
                    </div>
                </nav>
            </div>
            <div id="sections" class="col-8">
                <div id="about" class="section-hidden">
                    <h1>About Me <small class="text-muted">Who am I?</small></h1>
                    <p class="lead">
                        My name is Tom Zhu and I'm a second-year Computer Science Student at Carleton University. I started programming in the 11th grade and haven't looked back since! I really like building my own projects from scratch and learning new technology and frameworks. My main focuses have been with web and mobile development, but 
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
                    </p>
                    <hr class="divider divider-hidden"/>
                </div>
                <div id="projects" class="section-hidden">
                    <h1>Projects <small class="text-muted">What have I made?</small></h1>
                    <p class="lead">
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
                    </p>
                    <hr class="divider divider-hidden"/>
                </div>
                <div id="experience" class="section-hidden">
                    <h1>Experience <small class="text-muted">What have I done?</small></h1>
                    <p class="lead">
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
                    </p>
                    <hr class="divider divider-hidden"/>
                </div>
                <div id="contact" class="section-hidden">
                    <h1>Contact <small class="text-muted">Get in touch!</small></h1>
                    <p class="lead">
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
                    </p>
                </div>
            </div>
        </div>
        <nav class="navbar navbar-dark">
            <a class="navbar-brand" href="#">Fixed bottom</a>
        </nav>
    </body>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            let sections = [];

            let sectionsParent = document.querySelector("#sections");
            let topOfParent = sectionsParent.offsetTop;

            let topNav = document.querySelector("#navbarNav");
            let topNavLimit = topNav.offsetTop + topNav.offsetHeight + document.querySelector(".jumbotron").offsetHeight;
            
            let dividerLocations = [];
            let dividers = document.querySelectorAll(".divider");
            for (const hr of dividers) {
                console.log(hr);
                console.log(hr.offsetTop + hr.offsetParent.offsetTop + hr.offsetParent.offsetParent.offsetTop);
                dividerLocations.push(hr.offsetTop + hr.offsetParent.offsetTop + hr.offsetParent.offsetParent.offsetTop);
            }

            let sideNav = document.querySelector("#sideNav");
            let fullSideNav = document.querySelector("#fullNav");

            let navChildrenSide = sideNav.children;
            let navChildrenTop = document.querySelector("#topNav").children;
        
            for (const el of sectionsParent.children) {
                sections.push(el.offsetTop + topOfParent);
            }

            let isNavShown = toggleNavVisibility(fullSideNav, window.scrollY, topNavLimit, false);
            scrollSpy(navChildrenSide, navChildrenTop, sections, sectionsParent.children, dividers, dividerLocations);

            fullSideNav.addEventListener("animationend", () => {
                if (!isNavShown) fullSideNav.style.visibility = "hidden";
            });
                        
            document.addEventListener("scroll", () => {
                isNavShown = toggleNavVisibility(fullSideNav, window.scrollY, topNavLimit, isNavShown);
                scrollSpy(navChildrenSide, navChildrenTop, sections, sectionsParent.children, dividers, dividerLocations);
            });
        });

        function scrollSpy(navChildrenSide, navChildrenTop, sections, sectionDivs, dividers, dividerLocations) {
            let posY = window.scrollY + window.innerHeight;
            let wiggleRoom = window.innerHeight * 0.2;
            sections.forEach((top, index, arr) => {
                if (posY > top && sectionDivs[index].classList.contains("section-hidden")) {
                    console.log('reveal');
                    sectionDivs[index].classList.remove("section-hidden");
                    sectionDivs[index].classList.add("section-shown");
                }

                if (posY > top + wiggleRoom && (!sections[index+1] || posY < sections[index+1])) {
                    for (let i = 0; i < navChildrenTop.length; i++) {
                        navChildrenSide[i].classList.remove("active");
                        navChildrenTop[i].classList.remove("active");
                    }
                    navChildrenSide[index].classList.add("active");
                    navChildrenTop[index].classList.add("active");
                }
            });

            dividerLocations.forEach((val, index, arr) => {
                if (posY > val && dividers[index].classList.contains("divider-hidden")) {
                    console.log("passed");
                    dividers[index].classList.remove("divider-hidden");
                    dividers[index].classList.add("divider-expanded");
                }
            });
        }

        function toggleNavVisibility(nav, scrollPos, limit, prevIsNavShown) {
            if (scrollPos > limit && !prevIsNavShown) {
                nav.style.visibility = "visible";
                nav.classList.remove("nav-hidden");
                nav.classList.add("nav-shown");
                return true;
            } 
            else if (scrollPos < limit && prevIsNavShown) {
                nav.classList.remove("nav-shown");
                nav.classList.add("nav-hidden");
                return false;
            }
            return prevIsNavShown;
        }
    </script>
</html>